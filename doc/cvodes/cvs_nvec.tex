%===================================================================================
\chapter{Description of the NVECTOR module}\label{s:nvector}
%===================================================================================
\index{NVECTOR@\texttt{NVECTOR} module}
\input{nvec_generic}


%---------------------------------------------------------------------------
\section{NVECTOR functions used by CVODES}

In Table \ref{t:nvecuse} below, we list the vector functions in the
{\nvector} module used within the {\cvodes} package.
The table also shows, for each function, which of the code modules uses
the function. The {\cvodes} column shows function usage within the main
integrator module, while the remaining columns show function usage
within each of the {\cvodes} linear solver interfaces, the {\cvbandpre} and
{\cvbbdpre} preconditioner modules, and the {\cvodes} adjoint sensitivity
module (denoted here by {\cvodea}).  Here
{\cvls} stands for the generic linear solver interface in {\cvodes},
and {\cvdiag} stands for the diagonal linear solver interface in {\cvodes}.

At this point, we should emphasize that the {\cvodes} user does not need to know
anything about the usage of vector functions by the {\cvodes} code modules in order
to use {\cvodes}. The information is presented as an implementation detail for the
interested reader.

\begin{table}[htb]
\centering
\caption{List of vector functions usage by {\cvodes} code modules}\label{t:nvecuse}
\medskip
\begin{tabular}{|r|c|c|c|c|c|c|c|} \hline
                                             &
\begin{sideways}{\cvodes}     \end{sideways} &
\begin{sideways}{\cvls}       \end{sideways} &
\begin{sideways}{\cvdiag}     \end{sideways} &
\begin{sideways}{\cvbandpre}  \end{sideways} &
\begin{sideways}{\cvbbdpre}   \end{sideways} &
\begin{sideways}{\cvodea}     \end{sideways} \\ \hline\hline
%                                      CVODES  LS  DIAG  BPRE   BBD  CVODEA
\id{N\_VGetVectorID}                  &     &     &     &     &     &     \\ \hline
\id{N\_VGetLength}                    &     &  4  &     &     &     &     \\ \hline
\id{N\_VClone}                        & \cm & \cm & \cm &     &     & \cm \\ \hline
\id{N\_VCloneEmpty}                   &     &  1  &     &     &     &     \\ \hline
\id{N\_VDestroy}                      & \cm & \cm & \cm &     &     & \cm \\ \hline
\id{N\_VCloneVectorArray}             & \cm &     &     &     &     & \cm \\ \hline
\id{N\_VDestroyVectorArray}           & \cm &     &     &     &     & \cm \\ \hline
\id{N\_VSpace}                        & \cm &  2  &     &     &     &     \\ \hline
\id{N\_VGetArrayPointer}              &     &  1  &     & \cm & \cm &     \\ \hline
\id{N\_VSetArrayPointer}              &     &  1  &     &     &     &     \\ \hline
\id{N\_VLinearSum}                    & \cm & \cm & \cm &     &     & \cm \\ \hline
\id{N\_VConst}                        & \cm & \cm &     &     &     &     \\ \hline
\id{N\_VProd}                         & \cm &     & \cm &     &     &     \\ \hline
\id{N\_VDiv}                          & \cm &     & \cm &     &     &     \\ \hline
\id{N\_VScale}                        & \cm & \cm & \cm & \cm & \cm & \cm \\ \hline
\id{N\_VAbs}                          & \cm &     &     &     &     &     \\ \hline
\id{N\_VInv}                          & \cm &     & \cm &     &     &     \\ \hline
\id{N\_VAddConst}                     & \cm &     & \cm &     &     &     \\ \hline
\id{N\_VMaxNorm}                      & \cm &     &     &     &     &     \\ \hline
\id{N\_VWrmsNorm}                     & \cm & \cm &     & \cm & \cm &     \\ \hline
\id{N\_VMin}                          & \cm &     &     &     &     &     \\ \hline
\id{N\_MinQuotient}                   & \cm &     &     &     &     &     \\ \hline
\id{N\_VConstrMask}                   & \cm &     &     &     &     &     \\ \hline
\id{N\_VCompare}                      & \cm &     & \cm &     &     &     \\ \hline
\id{N\_VInvTest}                      &     &     & \cm &     &     &     \\ \hline
\hline
\id{N\_VLinearCombination}            & \cm &     &     &     &     &     \\ \hline
\id{N\_VScaleAddMulti}                & \cm &     &     &     &     &     \\ \hline
\id{N\_VDotProdMulti}                 &  3  &  3  &     &     &     &     \\ \hline
\hline
\id{N\_VLinearSumVectorArray}         & \cm &     &     &     &     &     \\ \hline
\id{N\_VScaleVectorArray}             & \cm &     &     &     &     &     \\ \hline
\id{N\_VConstVectorArray}             & \cm &     &     &     &     &     \\ \hline
\id{N\_VWrmsNormVectorArray}          & \cm &     &     &     &     &     \\ \hline
\id{N\_VScaleAddMultiVectorArray}     & \cm &     &     &     &     &     \\ \hline
\id{N\_VLinearCombinationVectorArray} & \cm &     &     &     &     &     \\ \hline
%
\end{tabular}
\end{table}

Special cases (numbers match markings in table):
\begin{enumerate}
\item These routines are only required if an internal
  difference-quotient routine for constructing dense or band
  Jacobian matrices is used.
\item This routine is optional, and is only used in estimating
  space requirements for {\cvodes} modules for user feedback.
\item The optional function \id{N\_VDotProdMulti} is only used in the
  {\sunnonlinsolfixedpoint} module, or when Classical Gram-Schmidt is
  enabled with {\spgmr} or {\spfgmr}.
\item This routine is only used when an iterative or matrix iterative
  {\sunlinsol} module is supplied to {\cvodes}.
\end{enumerate}

Each {\sunlinsol} object may require additional {\nvector} routines
not listed in the table above.  Please see the the relevant
descriptions of these modules in Sections
\ref{ss:sunlinsol_dense}-\ref{ss:sunlinsol_pcg} for additional detail
on their {\nvector} requirements.

The remaining operations from Tables \ref{ss:nvecops}, \ref{ss:nvecfusedops}, and
\ref{ss:nvecarrayops} not listed above
are unused and a user-supplied {\nvector} module for {\cvodes} could
omit these operations (although some may be needed by {\sunnonlinsol}
or {\sunlinsol} modules).  The functions \id{N\_MinQuotient},
\id{N\_VConstrMask}, and \id{N\_VCompare} are only used when
constraint checking is enabled and may be omitted if this feature is
not used.

%---------------------------------------------------------------------------
% nvector module sections
%---------------------------------------------------------------------------

\input{nvec_serial}
\input{nvec_parallel}
\input{nvec_openmp}
\input{nvec_pthreads}
\input{nvec_parhyp}
\input{nvec_petsc}
\input{nvec_cuda}
\input{nvec_hip}
\input{nvec_raja}
\input{nvec_sycl}
\input{nvec_openmpdev}
\input{nvec_trilinos}
\input{nvec_manyvector}
\input{nvec_mpimanyvector}
\input{nvec_mpiplusx}
\input{nvec_examples}
